{"ast":null,"code":"var _jsxFileName = \"/Users/kitan/Documents/CODING/group-chat-react-project/group-chat-react/src/Chatroom/ChatRoom.js\";\nimport './chatroom.css';\nimport Room from './RoomModel';\nimport Message from './MessageModel';\nimport React, { useState, useEffect } from 'react';\nimport io from 'socket.io-client';\nimport ChatMessage from './ChatMessage';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Chat extends React.Component {\n  constructor() {\n    super(props);\n    let room_ = new Room(\"25\", \"love isalnd ❤️\", \"kit\"); //props.data.room\n\n    let user_ = {\n      userName: \"kit\"\n    }; //props.data.user_\n\n    let isAdmin_ = room_.admin == user.userName ? true : false;\n    this.state = {\n      room: room_,\n      user: user_,\n      isAdmin: true,\n      newMessage: \"\",\n      messages: []\n    };\n    this.socket = null;\n  }\n\n  componentDidMount() {\n    this.connectSocket();\n    this.socketEvents();\n  }\n\n  connectSocket() {\n    this.socket = io(\"http://192.168.1.9:3000\", {\n      transport: ['websocket']\n    });\n  }\n\n  set(field, value) {\n    this.setState({\n      [field]: value\n    });\n  }\n\n  socketEvents() {\n    //socket functions\n    this.socket.on('connect', connection => {\n      if (this.isAdmin) this.socket.emit('create-room', this.room_.roomCode);else this.socket.emit('join-room', this.room_.roomCode);\n      console.log(\"connected.\");\n    });\n    this.socket.on('backlog-messages', messages_ => {\n      this.set(\"messages\", messages_);\n      console.log(\"messages received: \", messages_);\n    });\n    this.socket.on('broadcasted-message', message => {\n      console.log(\"received: \", message);\n      console.log([...this.state.messages, message]);\n      this.set(\"messages\", [...this.state.messages, message]);\n    });\n  }\n\n  setValue(setter, event) {\n    set(setter, event.target.value);\n  }\n\n  sendMessage() {\n    this.socket.emit(\"broadcast-message\", this.room.roomCode, this.newMessage, this.user.userName);\n    this.set(\"message\", \"\");\n  }\n\n  query_params(queryString) {\n    var queryParts = queryString.split('?');\n    var pairsString;\n    var query = {};\n    console.log(queryParts);\n    if (queryParts.length > 1) pairsString = queryParts[1].split('=');\n    console.log(pairsString);\n    let i = 0;\n\n    while (i < pairsString.length) {\n      query[pairsString[i]] = pairsString[i + 1];\n      i += 2;\n    }\n\n    console.log(query);\n    return query;\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"root\",\n      children: room ? /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"chatroom-view\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"title-view\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            class: \"title-text\",\n            children: room.roomName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"chatroom-messages-view\",\n          children: messages ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: messages.map(msg => /*#__PURE__*/_jsxDEV(ChatMessage, {\n              text: msg.message,\n              userName: \"\",\n              isUser: false\n            }, msg.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 125,\n              columnNumber: 45\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 21\n          }, this) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"typed-message-view\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: newMessage,\n            onChange: event => this.setValue(\"message\", event),\n            class: \"typed-message-input\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"i\", {\n            class: \"material-icons send-message-btn\",\n            onClick: sendMessage.bind(this),\n            children: \"\\uE163\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this) : null\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default Chat;\n/*\n\n\n      //let roomCode_ = localStorage.getItem(\"room-code\")\n        let isAdmin_ = localStorage.getItem('create-room')\n        let roomName_ = localStorage.getItem(\"room-name\")\n        let userName_ = localStorage.getItem(\"user-name\")\n        let room_ = {\n            name:roomName_,\n            admin: userName_,\n            password:\"xxx\",\n            code: roomCode_\n        }\n\n\n                <ChatMessage\n                text={\"Hi, Sweet! So, what do you wanna do today?Sweet! \"}\n                userName=\"name\"\n                isUser={true}\n            ></ChatMessage>\n            <ChatMessage\n                text={\"Hi, Sweet! So, what do you wanna do today?Sweet! \"}\n                userName=\"name\"\n                isUser={false}\n            ></ChatMessage>\n                    <ChatMessage\n                text={\"Hi, Sweet! So, what do you wanna do today?Sweet! \"}\n                userName=\"name\"\n                isUser={true}\n            ></ChatMessage>\n            <ChatMessage\n                text={\"Hi, Sweet! So, what do you wanna do today?Sweet! \"}\n                userName=\"name\"\n                isUser={false}\n            ></ChatMessage>\n                                <ChatMessage\n                text={\"Hi, Sweet! So, what do you wanna do today?Sweet! \"}\n                userName=\"name\"\n                isUser={true}\n            ></ChatMessage>\n*/","map":{"version":3,"sources":["/Users/kitan/Documents/CODING/group-chat-react-project/group-chat-react/src/Chatroom/ChatRoom.js"],"names":["Room","Message","React","useState","useEffect","io","ChatMessage","Chat","Component","constructor","props","room_","user_","userName","isAdmin_","admin","user","state","room","isAdmin","newMessage","messages","socket","componentDidMount","connectSocket","socketEvents","transport","set","field","value","setState","on","connection","emit","roomCode","console","log","messages_","message","setValue","setter","event","target","sendMessage","query_params","queryString","queryParts","split","pairsString","query","length","i","render","roomName","map","msg","id","bind"],"mappings":"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","sourcesContent":["import './chatroom.css';\nimport Room from './RoomModel'\nimport Message from './MessageModel'\n\nimport React, { useState,  useEffect} from 'react';\nimport io from 'socket.io-client';\n\n\nimport ChatMessage from './ChatMessage';\n\n\n\nclass Chat extends React.Component{\n\n\n    constructor(){\n\n        super(props)\n\n        let room_ = new Room(\"25\", \"love isalnd ❤️\", \"kit\")//props.data.room\n        let user_ = {userName:\"kit\"} //props.data.user_\n        let isAdmin_ = room_.admin == user.userName? true: false;\n\n        this.state ={\n            room: room_,\n            user: user_,\n            isAdmin: true,\n            newMessage: \"\",\n            messages: []\n        }\n\n        this.socket = null; \n    }\n\n    \n    componentDidMount(){\n        this.connectSocket()\n        this.socketEvents()\n    }\n\n    connectSocket(){\n        this.socket = io(\"http://192.168.1.9:3000\", { transport: ['websocket']}) ;\n    }\n\n\n    set(field, value){\n        this.setState({[field]: value})\n    }\n\n    socketEvents(){\n\n        //socket functions\n        this.socket.on('connect', (connection) => {\n            if(this.isAdmin)this.socket.emit('create-room', this.room_.roomCode)\n            else this.socket.emit('join-room', this.room_.roomCode)\n\n            console.log(\"connected.\")\n        });\n\n        this.socket.on('backlog-messages', (messages_) => {\n            this.set(\"messages\",messages_ )\n            console.log(\"messages received: \", messages_)\n        });\n\n        this.socket.on('broadcasted-message', (message) => {\n            console.log(\"received: \",message)\n            console.log([...this.state.messages,message])\n            this.set(\"messages\", [...this.state.messages,message])\n        });\n\n    }\n\n    setValue(setter, event){\n        set(setter, event.target.value)\n    }\n\n    sendMessage(){\n        this.socket.emit(\"broadcast-message\", this.room.roomCode, this.newMessage, this.user.userName)\n        this.set(\"message\", \"\")\n    }\n    \n\n\n\n    query_params(queryString){\n        \n        var queryParts = queryString.split('?')\n        var pairsString;\n        var query = {}\n\n        console.log(queryParts)\n        if(queryParts.length > 1) pairsString = queryParts[1].split('=');\n        console.log(pairsString)\n\n        let i=0;\n        while(i <pairsString.length){\n            query[pairsString[i]] = pairsString[i+1]\n            i+=2;\n        }\n        console.log(query)\n\n        return query\n    }\n\n    \n\n\n\n\n  \n    render(){\n\n        return (\n            <div class=\"root\">\n            {room?\n        \n                <div class=\"chatroom-view\">\n                <div class=\"title-view\">\n                    <p class=\"title-text\">{room.roomName}</p>\n                </div>\n                <div class=\"chatroom-messages-view\">\n            \n                    {messages?\n                    <div>\n                        {messages.map(msg=> <ChatMessage key={msg.id} text={msg.message} userName={\"\"} isUser={false}/>)}\n                        </div>\n                        :null\n                    }\n        \n                    </div>\n                    <div class=\"typed-message-view\">\n                    \n                        <input  type=\"text\" value={newMessage} onChange={(event)=> this.setValue(\"message\", event) }class=\"typed-message-input\"></input>\n                        <i class=\"material-icons send-message-btn\" onClick={sendMessage.bind(this)}>&#xe163;</i>\n        \n        \n                    </div>\n        \n                </div>\n                :null\n            }\n            </div>\n        );\n        \n    }\n    \n}\n\nexport default Chat;\n\n\n\n/*\n\n\n      //let roomCode_ = localStorage.getItem(\"room-code\")\n        let isAdmin_ = localStorage.getItem('create-room')\n        let roomName_ = localStorage.getItem(\"room-name\")\n        let userName_ = localStorage.getItem(\"user-name\")\n        let room_ = {\n            name:roomName_,\n            admin: userName_,\n            password:\"xxx\",\n            code: roomCode_\n        }\n\n\n                <ChatMessage\n                text={\"Hi, Sweet! So, what do you wanna do today?Sweet! \"}\n                userName=\"name\"\n                isUser={true}\n            ></ChatMessage>\n            <ChatMessage\n                text={\"Hi, Sweet! So, what do you wanna do today?Sweet! \"}\n                userName=\"name\"\n                isUser={false}\n            ></ChatMessage>\n                    <ChatMessage\n                text={\"Hi, Sweet! So, what do you wanna do today?Sweet! \"}\n                userName=\"name\"\n                isUser={true}\n            ></ChatMessage>\n            <ChatMessage\n                text={\"Hi, Sweet! So, what do you wanna do today?Sweet! \"}\n                userName=\"name\"\n                isUser={false}\n            ></ChatMessage>\n                                <ChatMessage\n                text={\"Hi, Sweet! So, what do you wanna do today?Sweet! \"}\n                userName=\"name\"\n                isUser={true}\n            ></ChatMessage>\n*/"]},"metadata":{},"sourceType":"module"}